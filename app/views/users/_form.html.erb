<% action = (user.persisted? ? user_url : users_url) %>
<% method = (user.persisted? ? "PATCH" : "POST") %>

<form action="<%= action %>" method="POST">
  <input type="hidden" name="_method" value=<%= method %>>
  <input type="hidden" name="authenticity_token"
    value="<%= form_authenticity_token %>">

  <label>Username
    <input  type="text"
            name="user[username]"
            value="<%= user.username %>">
  </label>
  <br>
  <label>Password
    <input type="password" name="user[password]">
  </label>
  <br>
  <input type="submit">
</form>
